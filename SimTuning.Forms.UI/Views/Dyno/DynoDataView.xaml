<?xml version="1.0" encoding="utf-8" ?>
<views:MvxContentPage BackgroundColor="{DynamicResource MaterialDesignPaper}"
                      xmlns="http://xamarin.com/schemas/2014/forms"
                      xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
                      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                      xmlns:d="http://xamarin.com/schemas/2014/forms/design"
                      xmlns:expandable="clr-namespace:Expandable;assembly=ExpandableView"
                      xmlns:views="clr-namespace:MvvmCross.Forms.Views;assembly=MvvmCross.Forms"
                      xmlns:viewModels="clr-namespace:SimTuning.Forms.UI.ViewModels.Dyno"
                      xmlns:material="clr-namespace:XF.Material.Forms.UI;assembly=XF.Material"
                      x:TypeArguments="viewModels:DynoDataViewModel"
                      mc:Ignorable="d"
                      Title="Datensatz"
                      x:Class="SimTuning.Forms.UI.Views.Dyno.DynoDataView">
    <ScrollView>
        <StackLayout>
            <!--<material:MaterialButton Margin="15"
                                     VerticalOptions="Center"
                                     HorizontalOptions="Start"
                                     ImageSource="ic_arrow_back_black_18dp.png"
                                     Command="{Binding CloseCommand}"
                                     WidthRequest="100"
                                     HeightRequest="60">
            </material:MaterialButton>-->

            <material:MaterialCard Margin="10"
                                   VerticalOptions="Center">
                <StackLayout>
                    <material:MaterialLabel Text="Auswahl"
                                            FontSize="Medium"
                                            FontAttributes="Bold" />

                    <BoxView Color="{DynamicResource MaterialDesignDivider}"
                             HeightRequest="2"
                             HorizontalOptions="Fill"
                             Margin="0, 0, 0, 5" />

                    <ListView HeightRequest="200"
                              ItemsSource="{Binding Mode=TwoWay, Path=Dynos}"
                              SelectedItem="{Binding Mode=TwoWay, Path=Dyno}"
                              RowHeight="50">
                        <ListView.ItemTemplate>
                            <DataTemplate>
                                <ViewCell>
                                    <StackLayout>
                                        <material:MaterialLabel Text="{Binding Name}"
                                                                FontAttributes="Bold"
                                                                Margin="0, 0, 0, -5" />
                                        <material:MaterialLabel Text="{Binding Beschreibung}" />
                                    </StackLayout>
                                </ViewCell>
                            </DataTemplate>
                        </ListView.ItemTemplate>
                    </ListView>

                    <StackLayout Orientation="Horizontal"
                                 HorizontalOptions="Center"
                                 Margin="5, 0, 0, 0">
                        <material:MaterialButton ImageSource="ic_add_circle_outline_black_18dp.png"
                                                 Command="{Binding NewDynoCommand}">
                        </material:MaterialButton>

                        <material:MaterialButton ImageSource="ic_remove_circle_outline_black_18dp.png"
                                                 Command="{Binding DeleteDynoCommand}">
                        </material:MaterialButton>
                    </StackLayout>

                    <Grid Margin="0, 20, 0, 0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="1.5*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>

                        <material:MaterialRadioButton x:Name="RB1"
                                                      Grid.Column="0"
                                                      Grid.Row="0"
                                                      Text="neues Fahrzeug erstellen"
                                                      IsSelected="{Binding Mode=TwoWay, Path=CreateNewVehicle}">
                            <material:MaterialRadioButton.Triggers>
                                <DataTrigger TargetType="material:MaterialRadioButton"
                                             Binding="{Binding Source={x:Reference RB2},Path=IsSelected}"
                                             Value="true">
                                    <Setter Property="IsSelected"
                                            Value="false" />
                                </DataTrigger>
                            </material:MaterialRadioButton.Triggers>
                        </material:MaterialRadioButton>

                        <material:MaterialRadioButton x:Name="RB2"
                                                      Grid.Column="0"
                                                      Grid.Row="1"
                                                      Text="vorhandenes Fahrzeug verknüpfen"
                                                      IsSelected="{Binding Mode=TwoWay, Path=TakeExistingVehicle}">
                            <material:MaterialRadioButton.Triggers>
                                <DataTrigger TargetType="material:MaterialRadioButton"
                                             Binding="{Binding Source={x:Reference RB1},Path=IsSelected}"
                                             Value="true">
                                    <Setter Property="IsSelected"
                                            Value="false" />
                                </DataTrigger>
                            </material:MaterialRadioButton.Triggers>
                        </material:MaterialRadioButton>

                        <material:MaterialTextField  Grid.Column="1"
                                                     Grid.Row="1"
                                                     VerticalOptions="End"
                                                     InputType="Choice"
                                                     FloatingPlaceholderEnabled="False"
                                                     Placeholder="Fahrzeug"
                                                     LeadingIcon="chevron_down"
                                                     IsEnabled="{Binding Source={x:Reference Name=RB2}, Path=IsSelected}"
                                                     Choices="{Binding Mode=TwoWay, Path=Vehicles}"
                                                     SelectedChoice="{Binding Mode=TwoWay, Path=Vehicle}"
                                                     ChoicesBindingName="Name">
                        </material:MaterialTextField>
                    </Grid>
                </StackLayout>
            </material:MaterialCard>

            <material:MaterialCard Margin="10">
                <StackLayout>
                    <material:MaterialLabel Text="Daten"
                                            FontSize="Medium"
                                            FontAttributes="Bold" />
                    <BoxView Color="{DynamicResource MaterialDesignDivider}"
                             HeightRequest="2"
                             HorizontalOptions="Fill"
                             Margin="0, 0, 0, 5" />

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="2*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <StackLayout Grid.Column="0">
                            <material:MaterialTextField Placeholder="Name"
                                                        Text="{Binding Mode=TwoWay, Path=DynoName}"
                                                        Margin="5">
                            </material:MaterialTextField>

                            <Editor Placeholder="Beschreibung"
                                    Text="{Binding Mode=TwoWay, Path=DynoBeschreibung}"
                                    HeightRequest="150"
                                    Margin="5">
                            </Editor>
                        </StackLayout>

                        <StackLayout  Grid.Column="1">
                            <material:MaterialButton Margin="15"
                                                     VerticalOptions="Center"
                                                     HorizontalOptions="Center"
                                                     ImageSource="content_save"
                                                     IsEnabled="{Binding Mode=OneWay, Path=SaveButton}"
                                                     Command="{Binding SaveDynoCommand}"
                                                     WidthRequest="100"
                                                     HeightRequest="60">
                            </material:MaterialButton>

                            <material:MaterialButton Margin="15"
                                                     VerticalOptions="Center"
                                                     HorizontalOptions="Center"
                                                     ImageSource="database_export"
                                                     Command="{Binding ExportDynoCommand}"
                                                     WidthRequest="100"
                                                     HeightRequest="60">
                            </material:MaterialButton>
                        </StackLayout>
                    </Grid>

                    <!--Audio-->
                    <expandable:ExpandableView>
                        <expandable:ExpandableView.PrimaryView>
                            <material:MaterialCard>
                                <material:MaterialLabel>
                                    Audio
                                </material:MaterialLabel>
                            </material:MaterialCard>
                        </expandable:ExpandableView.PrimaryView>
                        <expandable:ExpandableView.SecondaryViewTemplate>
                            <DataTemplate>
                                <StackLayout Orientation="Horizontal"
                                             Margin="20, 0, 0, 0">
                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="X"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.Drehzahl}"
                                                                ChoicesBindingName="Zeit">
                                    </material:MaterialTextField>

                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="Y"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.Drehzahl}"
                                                                ChoicesBindingName="Drehzahl">
                                    </material:MaterialTextField>
                                </StackLayout>
                            </DataTemplate>
                        </expandable:ExpandableView.SecondaryViewTemplate>
                    </expandable:ExpandableView>

                    <!--PS-->
                    <expandable:ExpandableView>
                        <expandable:ExpandableView.PrimaryView>
                            <material:MaterialCard>
                                <material:MaterialLabel>
                                    PS
                                </material:MaterialLabel>
                            </material:MaterialCard>
                        </expandable:ExpandableView.PrimaryView>
                        <expandable:ExpandableView.SecondaryViewTemplate>
                            <DataTemplate>
                                <StackLayout Orientation="Horizontal"
                                             Margin="20, 0, 0, 0">
                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="X"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.DynoPs}"
                                                                ChoicesBindingName="Drehzahl">
                                    </material:MaterialTextField>

                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="Y"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.DynoPs}"
                                                                ChoicesBindingName="Ps">
                                    </material:MaterialTextField>
                                </StackLayout>
                            </DataTemplate>
                        </expandable:ExpandableView.SecondaryViewTemplate>
                    </expandable:ExpandableView>

                    <!--Nm-->
                    <expandable:ExpandableView>
                        <expandable:ExpandableView.PrimaryView>
                            <material:MaterialCard>
                                <material:MaterialLabel>
                                    Nm
                                </material:MaterialLabel>
                            </material:MaterialCard>
                        </expandable:ExpandableView.PrimaryView>
                        <expandable:ExpandableView.SecondaryViewTemplate>
                            <DataTemplate>
                                <StackLayout Orientation="Horizontal"
                                             Margin="20, 0, 0, 0">
                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="X"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.DynoNm}"
                                                                ChoicesBindingName="Drehzahl">
                                    </material:MaterialTextField>

                                    <material:MaterialTextField InputType="Choice"
                                                                FloatingPlaceholderEnabled="False"
                                                                LeadingIcon="chevron_down"
                                                                Placeholder="Y"
                                                                WidthRequest="100"
                                                                Choices="{Binding Dyno.DynoNm}"
                                                                ChoicesBindingName="Nm">
                                    </material:MaterialTextField>
                                </StackLayout>
                            </DataTemplate>
                        </expandable:ExpandableView.SecondaryViewTemplate>
                    </expandable:ExpandableView>
                </StackLayout>
            </material:MaterialCard>

            <material:MaterialButton Margin="15"
                                     VerticalOptions="Center"
                                     HorizontalOptions="End"
                                     ImageSource="chevron_right"
                                     Command="{Binding ShowSettingsCommand}"
                                     WidthRequest="100"
                                     HeightRequest="60">
            </material:MaterialButton>
        </StackLayout>
    </ScrollView>
</views:MvxContentPage>